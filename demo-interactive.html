<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YellowGrid Interactive Demo - Chronological Workflow</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --yellow: #ffcb32;
      --yellow-soft: #ffe79a;
      --bg-dark: #0f1722;
      --bg-darker: #070c12;
      --bg-alt: #131b26;
      --card-bg: #161f2b;
      --accent-green: #46d38a;
      --accent-blue: #3b82f6;
      --accent-purple: #a78bfa;
      --accent-orange: #fb923c;
      --accent-red: #ff6b6b;
      --text-main: #e5ecf7;
      --text-muted: #9ba4b5;
      --border-subtle: #222b39;
      --shadow-soft: 0 22px 45px rgba(0, 0, 0, 0.45);
      --radius-lg: 18px;
      --radius-xl: 24px;
      --radius-pill: 999px;
      --transition-fast: 0.18s ease-out;

      /* Operator colors */
      --operator-primary: #1e3a8a;
      --operator-secondary: #3b82f6;
      --operator-bg: #0f1722;

      /* Crew colors */
      --crew-primary: #10b981;
      --crew-secondary: #34d399;
      --crew-bg: #f5f5f5;

      /* Customer colors */
      --customer-primary: #3b82f6;
      --customer-secondary: #a78bfa;
      --customer-bg: #ffffff;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #172133 0, #05070b 55%);
      color: var(--text-main);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Logo Styling - Exact from index.html */
    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logo-mark {
      width: 30px;
      height: 30px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--yellow), #ffdf80);
      display: grid;
      place-items: center;
      position: relative;
      box-shadow: 0 10px 25px rgba(255, 203, 50, 0.45);
    }

    .logo-mark::before {
      content: "";
      position: absolute;
      inset: 7px;
      border-radius: 7px;
      border: 2px solid rgba(0, 0, 0, 0.16);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.18);
    }

    .logo-mark-grid {
      width: 14px;
      height: 14px;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 1px;
      z-index: 1;
    }

    .logo-mark-cell {
      border-radius: 2px;
      background: rgba(0, 0, 0, 0.28);
    }

    .logo-mark-cell--active {
      background: #fff7d1;
    }

    .logo-text-main {
      font-weight: 650;
      letter-spacing: 0.02em;
      font-size: 1.06rem;
    }

    .logo-text-sub {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
    }

    /* Scenario Selection Screen */
    .scenario-selection {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .scenario-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .scenario-header h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      line-height: 1.1;
    }

    .scenario-header h1 span {
      color: var(--yellow);
    }

    .scenario-header p {
      color: var(--text-muted);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .scenario-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 3rem;
    }

    .scenario-card {
      background: var(--card-bg);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-xl);
      padding: 2rem;
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
      overflow: hidden;
    }

    .scenario-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-green), #4ade80);
    }

    .scenario-card.complex::before {
      background: linear-gradient(90deg, var(--accent-purple), #c4b5fd);
    }

    .scenario-card:hover {
      transform: translateY(-4px);
      border-color: var(--yellow);
      box-shadow: 0 12px 40px rgba(255, 203, 50, 0.2);
    }

    .scenario-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .scenario-card h3 {
      font-size: 1.3rem;
      margin-bottom: 0.75rem;
    }

    .scenario-card p {
      color: var(--text-muted);
      font-size: 0.95rem;
      margin-bottom: 1.25rem;
      line-height: 1.6;
    }

    .scenario-badge {
      display: inline-block;
      padding: 0.4rem 0.9rem;
      border-radius: var(--radius-pill);
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .badge-simple {
      background: rgba(70, 211, 138, 0.2);
      color: var(--accent-green);
    }

    .badge-complex {
      background: rgba(167, 139, 250, 0.2);
      color: var(--accent-purple);
    }

    /* Timeline Workflow Container */
    .timeline-wrapper {
      display: none;
      width: 100vw;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      background: var(--bg-darker);
    }

    .timeline-wrapper.active {
      display: flex;
      flex-direction: column;
    }

    /* Timeline Header */
    .timeline-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: var(--bg-dark);
      border-bottom: 1px solid var(--border-subtle);
      z-index: 100;
    }

    .timeline-left {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .back-to-scenarios {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 203, 50, 0.1);
      border: 1px solid rgba(255, 203, 50, 0.3);
      border-radius: var(--radius-pill);
      color: var(--yellow);
      cursor: pointer;
      font-size: 0.9rem;
      transition: all var(--transition-fast);
    }

    .back-to-scenarios:hover {
      background: rgba(255, 203, 50, 0.2);
      transform: translateX(-3px);
    }

    .timeline-progress {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .timeline-progress-text {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .timeline-progress-text strong {
      color: var(--yellow);
      font-size: 1.1rem;
    }

    .progress-dots {
      display: flex;
      gap: 0.5rem;
    }

    .progress-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--border-subtle);
      transition: all var(--transition-fast);
    }

    .progress-dot.active {
      background: var(--yellow);
      transform: scale(1.3);
    }

    .progress-dot.completed {
      background: var(--accent-green);
    }

    .timeline-stakeholder {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.6rem 1.2rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-pill);
      font-size: 0.9rem;
    }

    .stakeholder-icon {
      font-size: 1.2rem;
    }

    .stakeholder-customer .stakeholder-icon {
      color: var(--accent-blue);
    }

    .stakeholder-operator .stakeholder-icon {
      color: var(--accent-purple);
    }

    .stakeholder-crew .stakeholder-icon {
      color: var(--accent-green);
    }

    /* Workflow Container */
    .workflow-container {
      flex: 1;
      width: 100vw;
      overflow: hidden;
      position: relative;
    }

    .workflow-track {
      display: flex;
      height: 100%;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .workflow-card {
      min-width: 100vw;
      height: 100%;
      overflow-y: auto;
      position: relative;
    }

    /* Customer Portal Card */
    .customer-card {
      background: linear-gradient(to bottom, #f9fafb, #ffffff);
      color: #1f2937;
    }

    .customer-card .card-header {
      background: linear-gradient(135deg, var(--customer-primary), var(--customer-secondary));
      color: white;
      padding: 2rem;
    }

    .customer-card .card-content {
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }

    /* Operator Cockpit Card */
    .operator-card {
      background: linear-gradient(to bottom, #0f1722, #1a2332);
      color: var(--text-main);
    }

    .operator-card .card-header {
      background: linear-gradient(135deg, var(--operator-primary), var(--operator-secondary));
      padding: 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .operator-card .card-content {
      padding: 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Crew Mobile Card */
    .crew-card {
      background: #f5f5f5;
      color: #1f2937;
      display: flex;
      justify-content: center;
      align-items: start;
      padding: 2rem 1rem;
    }

    .crew-mobile-container {
      background: #000;
      border-radius: 40px;
      padding: 16px;
      max-width: 428px;
      width: 100%;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
    }

    .crew-mobile-screen {
      background: #fff;
      border-radius: 30px;
      overflow: hidden;
      position: relative;
    }

    .crew-mobile-notch {
      height: 40px;
      background: #000;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      width: 150px;
      margin: 0 auto;
    }

    .crew-mobile-content {
      padding: 1.5rem;
      min-height: 600px;
    }

    .crew-mobile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .crew-mobile-header h3 {
      font-size: 1.5rem;
      color: #1f2937;
    }

    /* Summary Card */
    .summary-card {
      background: linear-gradient(135deg, #1e293b, #0f172a);
      color: var(--text-main);
      padding: 3rem 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .summary-content {
      max-width: 900px;
      text-align: center;
    }

    .summary-content h2 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--yellow);
    }

    .summary-content p {
      font-size: 1.2rem;
      color: var(--text-muted);
      margin-bottom: 2rem;
    }

    /* Workflow Navigation */
    .workflow-navigation {
      display: flex;
      justify-content: space-between;
      padding: 1.5rem 2rem;
      background: var(--bg-dark);
      border-top: 1px solid var(--border-subtle);
    }

    .nav-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius-pill);
      border: none;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all var(--transition-fast);
    }

    .nav-btn.prev {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-main);
      border: 1px solid var(--border-subtle);
    }

    .nav-btn.prev:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(-3px);
    }

    .nav-btn.next {
      background: linear-gradient(135deg, var(--yellow), #ffd769);
      color: #1b1305;
      box-shadow: 0 4px 12px rgba(255, 203, 50, 0.3);
    }

    .nav-btn.next:hover:not(:disabled) {
      transform: translateX(3px);
      box-shadow: 0 6px 16px rgba(255, 203, 50, 0.4);
    }

    .nav-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .form-control {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1rem;
      transition: all var(--transition-fast);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--yellow);
      box-shadow: 0 0 0 3px rgba(255, 203, 50, 0.1);
    }

    textarea.form-control {
      min-height: 100px;
      resize: vertical;
    }

    .btn-submit {
      padding: 1rem 2rem;
      background: linear-gradient(135deg, var(--yellow), #ffd769);
      color: #1b1305;
      border: none;
      border-radius: var(--radius-pill);
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--transition-fast);
      width: 100%;
      margin-top: 1rem;
    }

    .btn-submit:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 203, 50, 0.4);
    }

    /* Dashboard Table */
    .dashboard-table {
      width: 100%;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border-subtle);
    }

    .dashboard-table thead {
      background: rgba(255, 255, 255, 0.05);
    }

    .dashboard-table th,
    .dashboard-table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-subtle);
    }

    .dashboard-table th {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      font-weight: 600;
    }

    .status-badge {
      padding: 0.35rem 0.75rem;
      border-radius: var(--radius-pill);
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      display: inline-block;
    }

    .status-new {
      background: rgba(59, 130, 246, 0.2);
      color: var(--accent-blue);
    }

    .status-assigned {
      background: rgba(251, 146, 60, 0.2);
      color: var(--accent-orange);
    }

    .status-in-progress {
      background: rgba(70, 211, 138, 0.2);
      color: var(--accent-green);
    }

    .status-completed {
      background: rgba(34, 197, 94, 0.3);
      color: #22c55e;
    }

    .btn-action {
      padding: 0.5rem 1rem;
      background: var(--yellow);
      color: #1b1305;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .btn-action:hover {
      background: var(--yellow-soft);
      transform: scale(1.05);
    }

    /* Checklist */
    .checklist {
      background: #f9fafb;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .checklist-item:hover {
      background: #f3f4f6;
    }

    .checklist-checkbox {
      width: 24px;
      height: 24px;
      border: 2px solid #d1d5db;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .checklist-item.completed .checklist-checkbox {
      background: var(--crew-primary);
      border-color: var(--crew-primary);
    }

    .checklist-item.completed {
      opacity: 0.6;
    }

    .checklist-item.completed .checklist-text {
      text-decoration: line-through;
    }

    /* Photo Grid */
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .photo-placeholder {
      aspect-ratio: 1;
      background: #e5e7eb;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--transition-fast);
      border: 2px dashed #9ca3af;
    }

    .photo-placeholder:hover {
      background: #d1d5db;
      border-color: var(--crew-primary);
    }

    .photo-item {
      aspect-ratio: 1;
      background: #10b981;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 2rem;
    }

    /* Signature Pad */
    .signature-container {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1rem;
    }

    .signature-pad {
      width: 100%;
      height: 200px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      cursor: crosshair;
      background: #fafafa;
    }

    .signature-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .btn-clear {
      padding: 0.5rem 1rem;
      background: #ef4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }

    /* Timeline Visualization */
    .timeline-viz {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 2rem;
      margin: 2rem 0;
    }

    .timeline-step {
      display: flex;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .timeline-step::before {
      content: '';
      position: absolute;
      left: 24px;
      top: 50px;
      width: 2px;
      height: calc(100% + 1rem);
      background: var(--border-subtle);
    }

    .timeline-step:last-child::before {
      display: none;
    }

    .timeline-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--yellow);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      flex-shrink: 0;
      z-index: 1;
    }

    .timeline-details h4 {
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }

    .timeline-details p {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .timeline-time {
      font-size: 0.8rem;
      color: var(--yellow);
      margin-top: 0.25rem;
    }

    /* Modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      padding: 2rem;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .modal-header h3 {
      font-size: 1.5rem;
    }

    .modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      transition: all var(--transition-fast);
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-main);
    }

    .technician-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .technician-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 2px solid transparent;
      transition: all var(--transition-fast);
      cursor: pointer;
    }

    .technician-item:hover {
      border-color: var(--yellow);
      background: rgba(255, 203, 50, 0.1);
    }

    .technician-info h4 {
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }

    .technician-info p {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .rating {
      color: var(--yellow);
      font-weight: 600;
    }

    /* Notification Badge */
    .notification-badge {
      background: var(--accent-red);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid var(--border-subtle);
    }

    .stat-card h4 {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .stat-card .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--yellow);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in-up {
      animation: fadeInUp 0.4s ease-out;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .timeline-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .workflow-navigation {
        padding: 1rem;
      }

      .operator-card .card-content,
      .customer-card .card-content {
        padding: 1rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Scenario Selection Screen -->
  <div id="scenarioSelection" class="scenario-selection">
    <div class="scenario-header">
      <div class="logo">
        <div class="logo-mark">
          <div class="logo-mark-grid">
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell logo-mark-cell--active"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
            <div class="logo-mark-cell"></div>
          </div>
        </div>
        <div>
          <div class="logo-text-main">YellowGrid</div>
          <div class="logo-text-sub">Service execution</div>
        </div>
      </div>

      <h1>Interactive <span>Workflow</span> Demo</h1>
      <p>Experience real-world scenarios step by step. See how YellowGrid connects operators, crews, and customers seamlessly.</p>
    </div>

    <div class="scenario-grid">
      <div class="scenario-card" onclick="startWorkflow('simple-installation')">
        <div class="scenario-icon">üîß</div>
        <h3>Simple Installation</h3>
        <p>A straightforward service installation flow from customer request to completed job with WCF signature.</p>
        <span class="scenario-badge badge-simple">8 Steps ‚Ä¢ 5 min</span>
      </div>

      <div class="scenario-card complex" onclick="startWorkflow('tv-quotation')">
        <div class="scenario-icon">üìã</div>
        <h3>TV & Quotation</h3>
        <p>Technical visit, quotation approval, and installation scheduling for complex jobs requiring assessment.</p>
        <span class="scenario-badge badge-complex">10 Steps ‚Ä¢ 7 min</span>
      </div>

      <div class="scenario-card" onclick="startWorkflow('package-deal')">
        <div class="scenario-icon">üì¶</div>
        <h3>Package Deal</h3>
        <p>Multi-service package with coordinated scheduling across different technician specialties.</p>
        <span class="scenario-badge badge-simple">9 Steps ‚Ä¢ 6 min</span>
      </div>

      <div class="scenario-card complex" onclick="startWorkflow('complex-project')">
        <div class="scenario-icon">üèóÔ∏è</div>
        <h3>Complex Project</h3>
        <p>Large-scale project with multiple phases, dependencies, and team coordination requirements.</p>
        <span class="scenario-badge badge-complex">12 Steps ‚Ä¢ 10 min</span>
      </div>

      <div class="scenario-card" onclick="startWorkflow('rework-warranty')">
        <div class="scenario-icon">üîÑ</div>
        <h3>Rework & Warranty</h3>
        <p>Quality issue detected, rework scheduled, and warranty claim processed with documentation.</p>
        <span class="scenario-badge badge-simple">7 Steps ‚Ä¢ 4 min</span>
      </div>
    </div>
  </div>

  <!-- Timeline Workflow -->
  <div id="timelineWorkflow" class="timeline-wrapper">
    <!-- Timeline Header -->
    <div class="timeline-header">
      <div class="timeline-left">
        <button class="back-to-scenarios" onclick="exitWorkflow()">
          <i class="fas fa-arrow-left"></i>
          Back to Scenarios
        </button>

        <div class="logo">
          <div class="logo-mark">
            <div class="logo-mark-grid">
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell logo-mark-cell--active"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
              <div class="logo-mark-cell"></div>
            </div>
          </div>
          <div>
            <div class="logo-text-main">YellowGrid</div>
          </div>
        </div>
      </div>

      <div class="timeline-progress">
        <div class="timeline-progress-text">
          Step <strong id="currentStepNum">1</strong> of <strong id="totalStepsNum">8</strong>
        </div>
        <div class="progress-dots" id="progressDots"></div>
      </div>

      <div class="timeline-stakeholder" id="stakeholderIndicator">
        <i class="fas fa-user stakeholder-icon"></i>
        <span id="stakeholderName">Customer</span>
      </div>
    </div>

    <!-- Workflow Container -->
    <div class="workflow-container">
      <div class="workflow-track" id="workflowTrack">
        <!-- Step 1: Customer Portal - New Service Request -->
        <div class="workflow-card customer-card">
          <div class="card-header">
            <h2><i class="fas fa-user"></i> Customer Portal</h2>
            <p>Submit a new service request</p>
          </div>
          <div class="card-content">
            <div class="fade-in-up">
              <h3 style="margin-bottom: 1.5rem;">Request a Service</h3>

              <form id="customerRequestForm" onsubmit="submitServiceRequest(event)">
                <div class="form-group">
                  <label>Service Type</label>
                  <select class="form-control" id="serviceType" required>
                    <option value="">Select a service...</option>
                    <option value="Air Conditioning Installation">Air Conditioning Installation</option>
                    <option value="Kitchen Installation">Kitchen Installation</option>
                    <option value="Bathroom Renovation">Bathroom Renovation</option>
                    <option value="Electrical Work">Electrical Work</option>
                    <option value="Plumbing">Plumbing</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Customer Name</label>
                  <input type="text" class="form-control" id="customerName" value="Maria Santos" required>
                </div>

                <div class="form-group">
                  <label>Phone Number</label>
                  <input type="tel" class="form-control" id="customerPhone" value="+351 912 345 678" required>
                </div>

                <div class="form-group">
                  <label>Email</label>
                  <input type="email" class="form-control" id="customerEmail" value="maria.santos@email.com" required>
                </div>

                <div class="form-group">
                  <label>Address</label>
                  <input type="text" class="form-control" id="customerAddress" value="Rua das Flores 45, Lisboa" required>
                </div>

                <div class="form-group">
                  <label>Service Description</label>
                  <textarea class="form-control" id="serviceDescription" required>Need to install a new air conditioning unit in the living room. Wall mounting required.</textarea>
                </div>

                <div class="form-group">
                  <label>Preferred Date</label>
                  <input type="date" class="form-control" id="preferredDate" required>
                </div>

                <div class="form-group">
                  <label>Preferred Time</label>
                  <select class="form-control" id="preferredTime" required>
                    <option value="09:00">Morning (09:00 - 12:00)</option>
                    <option value="14:00" selected>Afternoon (14:00 - 17:00)</option>
                    <option value="17:00">Evening (17:00 - 20:00)</option>
                  </select>
                </div>

                <button type="submit" class="btn-submit">
                  <i class="fas fa-paper-plane"></i> Submit Service Request
                </button>
              </form>
            </div>
          </div>
        </div>

        <!-- Step 2: Operator Cockpit - Review & Assign -->
        <div class="workflow-card operator-card">
          <div class="card-header">
            <h2><i class="fas fa-desktop"></i> Operator Cockpit</h2>
            <p>Review new requests and assign technicians</p>
          </div>
          <div class="card-content">
            <div class="fade-in-up">
              <div class="stats-grid">
                <div class="stat-card">
                  <h4>New Requests</h4>
                  <div class="stat-value">1</div>
                </div>
                <div class="stat-card">
                  <h4>In Progress</h4>
                  <div class="stat-value">3</div>
                </div>
                <div class="stat-card">
                  <h4>Available Crews</h4>
                  <div class="stat-value">5</div>
                </div>
              </div>

              <h3 style="margin-bottom: 1rem;">Service Queue</h3>

              <table class="dashboard-table">
                <thead>
                  <tr>
                    <th>Service ID</th>
                    <th>Customer</th>
                    <th>Service Type</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="serviceQueueTable">
                  <tr>
                    <td><strong id="serviceIdDisplay">-</strong></td>
                    <td id="customerNameDisplay">-</td>
                    <td id="serviceTypeDisplay">-</td>
                    <td id="serviceDateDisplay">-</td>
                    <td><span class="status-badge status-new">New</span></td>
                    <td>
                      <button class="btn-action" onclick="openTechnicianModal()">
                        <i class="fas fa-user-plus"></i> Assign Technician
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Step 3: Crew Mobile App - Job Assignment Notification -->
        <div class="workflow-card crew-card">
          <div class="crew-mobile-container">
            <div class="crew-mobile-screen">
              <div class="crew-mobile-notch"></div>
              <div class="crew-mobile-content">
                <div class="crew-mobile-header">
                  <h3>New Assignment</h3>
                  <div class="notification-badge">1</div>
                </div>

                <div style="background: #ecfdf5; border-left: 4px solid #10b981; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <i class="fas fa-bell" style="color: #10b981;"></i>
                    <strong style="color: #065f46;">New Job Assigned</strong>
                  </div>
                  <p style="color: #047857; font-size: 0.9rem; margin: 0;">You have been assigned to a new service request</p>
                </div>

                <div style="background: white; border-radius: 12px; padding: 1.25rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 1.5rem;">
                  <h4 style="margin-bottom: 1rem; color: #1f2937;">Job Details</h4>

                  <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                    <div>
                      <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 0.25rem;">Service ID</div>
                      <div style="font-weight: 600; color: #1f2937;" id="crewServiceId">-</div>
                    </div>

                    <div>
                      <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 0.25rem;">Service Type</div>
                      <div style="font-weight: 600; color: #1f2937;" id="crewServiceType">-</div>
                    </div>

                    <div>
                      <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 0.25rem;">Customer</div>
                      <div style="font-weight: 600; color: #1f2937;" id="crewCustomerName">-</div>
                    </div>

                    <div>
                      <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 0.25rem;">Address</div>
                      <div style="color: #1f2937;" id="crewAddress">-</div>
                    </div>

                    <div>
                      <div style="font-size: 0.8rem; color: #6b7280; margin-bottom: 0.25rem;">Scheduled</div>
                      <div style="color: #1f2937;" id="crewSchedule">-</div>
                    </div>
                  </div>
                </div>

                <div style="display: flex; gap: 1rem;">
                  <button onclick="acceptJob()" style="flex: 1; padding: 1rem; background: #10b981; color: white; border: none; border-radius: 12px; font-weight: 700; font-size: 1rem; cursor: pointer;">
                    <i class="fas fa-check"></i> Accept Job
                  </button>
                  <button onclick="rejectJob()" style="flex: 1; padding: 1rem; background: #ef4444; color: white; border: none; border-radius: 12px; font-weight: 700; font-size: 1rem; cursor: pointer;">
                    <i class="fas fa-times"></i> Reject
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4: Crew Mobile App - Check In -->
        <div class="workflow-card crew-card">
          <div class="crew-mobile-container">
            <div class="crew-mobile-screen">
              <div class="crew-mobile-notch"></div>
              <div class="crew-mobile-content">
                <div class="crew-mobile-header">
                  <h3>Check In</h3>
                  <span class="status-badge" style="background: #10b981; color: white;">Accepted</span>
                </div>

                <div style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 1.5rem;">
                  <h4 style="margin-bottom: 1rem; color: #1f2937;">Job Summary</h4>
                  <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.9rem;">
                    <div style="display: flex; justify-content: space-between;">
                      <span style="color: #6b7280;">Service:</span>
                      <span style="font-weight: 600; color: #1f2937;" id="checkInServiceType">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                      <span style="color: #6b7280;">Customer:</span>
                      <span style="font-weight: 600; color: #1f2937;" id="checkInCustomer">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                      <span style="color: #6b7280;">Time:</span>
                      <span style="font-weight: 600; color: #1f2937;" id="checkInTime">-</span>
                    </div>
                  </div>
                </div>

                <div style="background: #fef3c7; border-radius: 12px; padding: 1.5rem; text-align: center; margin-bottom: 1.5rem;">
                  <i class="fas fa-map-marker-alt" style="font-size: 3rem; color: #f59e0b; margin-bottom: 0.5rem;"></i>
                  <p style="color: #92400e; font-weight: 600; margin-bottom: 0.25rem;">You are at the location</p>
                  <p style="color: #78350f; font-size: 0.85rem;" id="checkInAddress">-</p>
                </div>

                <button onclick="checkIn()" style="width: 100%; padding: 1.25rem; background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; border-radius: 12px; font-weight: 700; font-size: 1.1rem; cursor: pointer; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">
                  <i class="fas fa-sign-in-alt"></i> Check In Now
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Crew Mobile App - Work Execution -->
        <div class="workflow-card crew-card">
          <div class="crew-mobile-container">
            <div class="crew-mobile-screen">
              <div class="crew-mobile-notch"></div>
              <div class="crew-mobile-content">
                <div class="crew-mobile-header">
                  <h3>Work in Progress</h3>
                  <span class="status-badge" style="background: #10b981; color: white;">In Progress</span>
                </div>

                <h4 style="margin-bottom: 0.75rem; color: #1f2937;">Installation Checklist</h4>
                <div class="checklist" id="workChecklist">
                  <div class="checklist-item" onclick="toggleChecklistItem(1)">
                    <div class="checklist-checkbox" id="check-1">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Verify customer identity and service order</div>
                  </div>
                  <div class="checklist-item" onclick="toggleChecklistItem(2)">
                    <div class="checklist-checkbox" id="check-2">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Inspect installation location</div>
                  </div>
                  <div class="checklist-item" onclick="toggleChecklistItem(3)">
                    <div class="checklist-checkbox" id="check-3">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Take before photos</div>
                  </div>
                  <div class="checklist-item" onclick="toggleChecklistItem(4)">
                    <div class="checklist-checkbox" id="check-4">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Install equipment</div>
                  </div>
                  <div class="checklist-item" onclick="toggleChecklistItem(5)">
                    <div class="checklist-checkbox" id="check-5">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Test system operation</div>
                  </div>
                  <div class="checklist-item" onclick="toggleChecklistItem(6)">
                    <div class="checklist-checkbox" id="check-6">
                      <i class="fas fa-check" style="color: white; font-size: 0.75rem; display: none;"></i>
                    </div>
                    <div class="checklist-text">Clean work area</div>
                  </div>
                </div>

                <h4 style="margin-bottom: 0.75rem; color: #1f2937;">Photos</h4>
                <div class="photo-grid" id="photoGrid">
                  <div class="photo-placeholder" onclick="addPhoto()">
                    <i class="fas fa-camera" style="font-size: 2rem; color: #9ca3af;"></i>
                  </div>
                </div>

                <button onclick="completeJob()" style="width: 100%; padding: 1rem; background: #10b981; color: white; border: none; border-radius: 12px; font-weight: 700; margin-top: 1rem; cursor: pointer;">
                  <i class="fas fa-check-circle"></i> Complete Job
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 6: Customer Portal - WCF Signature -->
        <div class="workflow-card customer-card">
          <div class="card-header">
            <h2><i class="fas fa-user"></i> Customer Portal</h2>
            <p>Review completed work and sign WCF</p>
          </div>
          <div class="card-content">
            <div class="fade-in-up">
              <div style="background: #ecfdf5; border-left: 4px solid #10b981; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                  <i class="fas fa-check-circle" style="color: #10b981; font-size: 1.5rem;"></i>
                  <strong style="color: #065f46; font-size: 1.2rem;">Work Completed!</strong>
                </div>
                <p style="color: #047857; margin: 0;">Your service has been completed. Please review the work and sign the Work Closing Form.</p>
              </div>

              <h3 style="margin-bottom: 1rem;">Work Summary</h3>

              <div style="background: #f9fafb; border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1rem;">
                  <div>
                    <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Service Type</div>
                    <div style="font-weight: 600; color: #1f2937;" id="wcfServiceType">-</div>
                  </div>
                  <div>
                    <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Technician</div>
                    <div style="font-weight: 600; color: #1f2937;" id="wcfTechnician">-</div>
                  </div>
                  <div>
                    <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Date</div>
                    <div style="font-weight: 600; color: #1f2937;" id="wcfDate">-</div>
                  </div>
                  <div>
                    <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Duration</div>
                    <div style="font-weight: 600; color: #1f2937;" id="wcfDuration">2.5 hours</div>
                  </div>
                </div>

                <h4 style="margin-top: 1.5rem; margin-bottom: 0.75rem; color: #1f2937;">Work Performed</h4>
                <ul style="color: #4b5563; padding-left: 1.5rem;">
                  <li style="margin-bottom: 0.5rem;">Equipment installed and tested</li>
                  <li style="margin-bottom: 0.5rem;">All safety checks completed</li>
                  <li style="margin-bottom: 0.5rem;">Work area cleaned</li>
                  <li>Customer walkthrough provided</li>
                </ul>
              </div>

              <h4 style="margin-bottom: 1rem;">Photos</h4>
              <div class="photo-grid" style="margin-bottom: 2rem;">
                <div class="photo-item"><i class="fas fa-image"></i></div>
                <div class="photo-item"><i class="fas fa-image"></i></div>
                <div class="photo-item"><i class="fas fa-image"></i></div>
              </div>

              <div class="signature-container">
                <h4 style="margin-bottom: 1rem;">Sign Work Closing Form</h4>
                <p style="color: #6b7280; margin-bottom: 1rem; font-size: 0.9rem;">Please sign below to confirm that the work has been completed to your satisfaction.</p>

                <canvas id="signaturePad" class="signature-pad"></canvas>

                <div class="signature-actions">
                  <button class="btn-clear" onclick="clearSignature()">
                    <i class="fas fa-eraser"></i> Clear
                  </button>
                  <button class="btn-submit" onclick="signWCF()">
                    <i class="fas fa-signature"></i> Sign & Submit
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 7: Operator Cockpit - Confirm & Close -->
        <div class="workflow-card operator-card">
          <div class="card-header">
            <h2><i class="fas fa-desktop"></i> Operator Cockpit</h2>
            <p>Confirm completion and process payment</p>
          </div>
          <div class="card-content">
            <div class="fade-in-up">
              <div style="background: rgba(16, 185, 129, 0.1); border-left: 4px solid #10b981; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                  <i class="fas fa-check-circle" style="color: #10b981; font-size: 1.5rem;"></i>
                  <strong style="color: #10b981; font-size: 1.2rem;">WCF Signed</strong>
                </div>
                <p style="color: var(--text-muted); margin: 0;">Customer has signed the Work Closing Form. Ready to process payment and close the service.</p>
              </div>

              <h3 style="margin-bottom: 1rem;">Service Completion Details</h3>

              <table class="dashboard-table" style="margin-bottom: 2rem;">
                <thead>
                  <tr>
                    <th>Service ID</th>
                    <th>Customer</th>
                    <th>Technician</th>
                    <th>Completed</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong id="finalServiceId">-</strong></td>
                    <td id="finalCustomer">-</td>
                    <td id="finalTechnician">-</td>
                    <td id="finalCompletedTime">-</td>
                    <td><span class="status-badge status-completed">WCF Signed</span></td>
                  </tr>
                </tbody>
              </table>

              <div style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 2rem;">
                <h4 style="margin-bottom: 1.5rem;">Payment Processing</h4>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin-bottom: 2rem;">
                  <div>
                    <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.5rem;">Service Amount</div>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--yellow);">‚Ç¨850.00</div>
                  </div>
                  <div>
                    <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.5rem;">Payment Method</div>
                    <select class="form-control" id="paymentMethod" style="background: rgba(255, 255, 255, 0.05); color: var(--text-main); border-color: var(--border-subtle);">
                      <option>Visa ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4532</option>
                      <option>Bank Transfer</option>
                      <option>Cash</option>
                    </select>
                  </div>
                </div>

                <button onclick="processPayment()" class="btn-submit">
                  <i class="fas fa-credit-card"></i> Process Payment & Close Service
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 8: Summary Screen -->
        <div class="workflow-card summary-card">
          <div class="summary-content fade-in-up">
            <i class="fas fa-check-circle" style="font-size: 4rem; color: var(--yellow); margin-bottom: 1rem;"></i>
            <h2>Workflow Complete!</h2>
            <p>You've successfully completed the "Simple Installation" workflow. Here's what happened:</p>

            <div class="timeline-viz">
              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-blue);">
                  <i class="fas fa-user"></i>
                </div>
                <div class="timeline-details">
                  <h4>Customer Request Submitted</h4>
                  <p>Maria Santos requested an Air Conditioning Installation</p>
                  <div class="timeline-time">Step 1</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-purple);">
                  <i class="fas fa-desktop"></i>
                </div>
                <div class="timeline-details">
                  <h4>Operator Assigned Technician</h4>
                  <p id="summaryTechnician">Technician assigned to the job</p>
                  <div class="timeline-time">Step 2</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-green);">
                  <i class="fas fa-mobile-alt"></i>
                </div>
                <div class="timeline-details">
                  <h4>Crew Accepted Job</h4>
                  <p>Job assignment accepted and confirmed</p>
                  <div class="timeline-time">Step 3</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-green);">
                  <i class="fas fa-map-marker-alt"></i>
                </div>
                <div class="timeline-details">
                  <h4>Checked In at Location</h4>
                  <p>Technician arrived and checked in</p>
                  <div class="timeline-time">Step 4</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-green);">
                  <i class="fas fa-tools"></i>
                </div>
                <div class="timeline-details">
                  <h4>Work Executed</h4>
                  <p>Installation completed with checklist and photos</p>
                  <div class="timeline-time">Step 5</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-blue);">
                  <i class="fas fa-signature"></i>
                </div>
                <div class="timeline-details">
                  <h4>Customer Signed WCF</h4>
                  <p>Work Closing Form signed and approved</p>
                  <div class="timeline-time">Step 6</div>
                </div>
              </div>

              <div class="timeline-step">
                <div class="timeline-icon" style="background: var(--accent-purple);">
                  <i class="fas fa-credit-card"></i>
                </div>
                <div class="timeline-details">
                  <h4>Payment Processed</h4>
                  <p>Service completed and payment received</p>
                  <div class="timeline-time">Step 7</div>
                </div>
              </div>
            </div>

            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
              <button onclick="exitWorkflow()" class="btn-submit" style="max-width: 300px;">
                <i class="fas fa-redo"></i> Try Another Scenario
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Workflow Navigation -->
    <div class="workflow-navigation">
      <button class="nav-btn prev" onclick="previousStep()" id="prevBtn">
        <i class="fas fa-arrow-left"></i> Previous
      </button>
      <button class="nav-btn next" onclick="nextStep()" id="nextBtn">
        Next <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>

  <!-- Technician Assignment Modal -->
  <div id="technicianModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Assign Technician</h3>
        <button class="modal-close" onclick="closeTechnicianModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="technician-list" id="technicianList">
        <div class="technician-item" onclick="selectTechnician('PRO-1547', 'Jo√£o Ferreira', 4.9)">
          <div class="technician-info">
            <h4>Jo√£o Ferreira</h4>
            <p>Skills: AC Installation, Electrical, Plumbing</p>
            <p style="font-size: 0.8rem; color: var(--accent-green);">Available</p>
          </div>
          <div class="rating">
            <i class="fas fa-star"></i> 4.9
          </div>
        </div>

        <div class="technician-item" onclick="selectTechnician('PRO-1823', 'Carlos Mendes', 4.8)">
          <div class="technician-info">
            <h4>Carlos Mendes</h4>
            <p>Skills: Bathroom, Tiling, Plumbing</p>
            <p style="font-size: 0.8rem; color: var(--accent-green);">Available</p>
          </div>
          <div class="rating">
            <i class="fas fa-star"></i> 4.8
          </div>
        </div>

        <div class="technician-item" onclick="selectTechnician('PRO-2156', 'Ana Costa', 5.0)">
          <div class="technician-info">
            <h4>Ana Costa</h4>
            <p>Skills: Plumbing, Heating, General</p>
            <p style="font-size: 0.8rem; color: var(--accent-green);">Available</p>
          </div>
          <div class="rating">
            <i class="fas fa-star"></i> 5.0
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Load YellowGrid State Management -->
  <script src="yellowgrid-state.js"></script>

  <script>
    // Workflow State
    let currentStep = 0;
    const totalSteps = 8;
    let currentScenario = '';
    let workflowServiceId = '';
    let selectedTechnicianId = '';
    let selectedTechnicianName = '';
    let checklistState = [false, false, false, false, false, false];
    let photoCount = 0;
    let signatureCanvas = null;
    let signatureCtx = null;
    let isDrawing = false;

    // Start Workflow
    function startWorkflow(scenario) {
      currentScenario = scenario;
      currentStep = 0;

      // Hide scenario selection, show timeline
      document.getElementById('scenarioSelection').style.display = 'none';
      document.getElementById('timelineWorkflow').classList.add('active');

      // Initialize workflow
      updateWorkflowView();

      // Set default date to tomorrow
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      document.getElementById('preferredDate').valueAsDate = tomorrow;

      // Initialize signature pad
      setTimeout(initSignaturePad, 500);
    }

    // Exit Workflow
    function exitWorkflow() {
      document.getElementById('scenarioSelection').style.display = 'block';
      document.getElementById('timelineWorkflow').classList.remove('active');

      // Reset workflow state
      currentStep = 0;
      checklistState = [false, false, false, false, false, false];
      photoCount = 0;
    }

    // Next Step
    function nextStep() {
      if (currentStep < totalSteps - 1) {
        currentStep++;
        updateWorkflowView();
      }
    }

    // Previous Step
    function previousStep() {
      if (currentStep > 0) {
        currentStep--;
        updateWorkflowView();
      }
    }

    // Update Workflow View
    function updateWorkflowView() {
      const track = document.getElementById('workflowTrack');
      track.style.transform = `translateX(-${currentStep * 100}vw)`;

      // Update progress
      document.getElementById('currentStepNum').textContent = currentStep + 1;
      document.getElementById('totalStepsNum').textContent = totalSteps;

      // Update progress dots
      updateProgressDots();

      // Update stakeholder indicator
      updateStakeholderIndicator();

      // Update navigation buttons
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      prevBtn.disabled = currentStep === 0;
      nextBtn.disabled = currentStep === totalSteps - 1;

      // Update next button text
      if (currentStep === totalSteps - 1) {
        nextBtn.innerHTML = '<i class="fas fa-flag-checkered"></i> Finish';
      } else {
        nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
      }
    }

    // Update Progress Dots
    function updateProgressDots() {
      const dotsContainer = document.getElementById('progressDots');
      dotsContainer.innerHTML = '';

      for (let i = 0; i < totalSteps; i++) {
        const dot = document.createElement('div');
        dot.className = 'progress-dot';

        if (i < currentStep) {
          dot.classList.add('completed');
        } else if (i === currentStep) {
          dot.classList.add('active');
        }

        dotsContainer.appendChild(dot);
      }
    }

    // Update Stakeholder Indicator
    function updateStakeholderIndicator() {
      const indicator = document.getElementById('stakeholderIndicator');
      const stakeholders = [
        { icon: 'user', name: 'Customer', class: 'stakeholder-customer' },
        { icon: 'desktop', name: 'Operator', class: 'stakeholder-operator' },
        { icon: 'mobile-alt', name: 'Crew', class: 'stakeholder-crew' },
        { icon: 'map-marker-alt', name: 'Crew', class: 'stakeholder-crew' },
        { icon: 'tools', name: 'Crew', class: 'stakeholder-crew' },
        { icon: 'user', name: 'Customer', class: 'stakeholder-customer' },
        { icon: 'desktop', name: 'Operator', class: 'stakeholder-operator' },
        { icon: 'trophy', name: 'Summary', class: 'stakeholder-operator' }
      ];

      const stakeholder = stakeholders[currentStep];
      indicator.className = `timeline-stakeholder ${stakeholder.class}`;
      indicator.innerHTML = `
        <i class="fas fa-${stakeholder.icon} stakeholder-icon"></i>
        <span id="stakeholderName">${stakeholder.name}</span>
      `;
    }

    // Step 1: Submit Service Request
    function submitServiceRequest(event) {
      event.preventDefault();

      // Generate service ID
      workflowServiceId = 'DEMO-' + Date.now().toString().slice(-6);

      // Get form data
      const formData = {
        id: workflowServiceId,
        type: document.getElementById('serviceType').value,
        customer: {
          name: document.getElementById('customerName').value,
          phone: document.getElementById('customerPhone').value,
          email: document.getElementById('customerEmail').value,
          address: document.getElementById('customerAddress').value
        },
        description: document.getElementById('serviceDescription').value,
        schedule: {
          date: document.getElementById('preferredDate').value,
          startTime: document.getElementById('preferredTime').value,
          estimatedHours: 3
        },
        status: 'new',
        pricing: {
          amount: 850.00,
          paid: false
        },
        checklist: [],
        photos: [],
        createdAt: new Date().toISOString()
      };

      // Store in state (creating new service)
      window.ygState.state.services[workflowServiceId] = formData;
      window.ygState.save();

      // Update Step 2 display
      document.getElementById('serviceIdDisplay').textContent = workflowServiceId;
      document.getElementById('customerNameDisplay').textContent = formData.customer.name;
      document.getElementById('serviceTypeDisplay').textContent = formData.type;
      document.getElementById('serviceDateDisplay').textContent = formData.schedule.date;

      // Auto-advance to next step
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 2: Open Technician Modal
    function openTechnicianModal() {
      document.getElementById('technicianModal').classList.add('active');
    }

    function closeTechnicianModal() {
      document.getElementById('technicianModal').classList.remove('active');
    }

    // Step 2: Select Technician
    function selectTechnician(techId, techName, rating) {
      selectedTechnicianId = techId;
      selectedTechnicianName = techName;

      // Assign technician using state management
      window.ygState.assignTechnician(workflowServiceId, techId);

      // Update Step 3 crew display
      const service = window.ygState.getService(workflowServiceId);
      document.getElementById('crewServiceId').textContent = workflowServiceId;
      document.getElementById('crewServiceType').textContent = service.type;
      document.getElementById('crewCustomerName').textContent = service.customer.name;
      document.getElementById('crewAddress').textContent = service.customer.address;
      document.getElementById('crewSchedule').textContent =
        `${service.schedule.date} at ${service.schedule.startTime}`;

      // Close modal
      closeTechnicianModal();

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 3: Accept Job
    function acceptJob() {
      window.ygState.acceptJob(workflowServiceId, selectedTechnicianId);

      // Update Step 4 check-in display
      const service = window.ygState.getService(workflowServiceId);
      document.getElementById('checkInServiceType').textContent = service.type;
      document.getElementById('checkInCustomer').textContent = service.customer.name;
      document.getElementById('checkInTime').textContent = service.schedule.startTime;
      document.getElementById('checkInAddress').textContent = service.customer.address;

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 3: Reject Job
    function rejectJob() {
      const reason = prompt('Reason for rejection:');
      if (reason) {
        window.ygState.rejectJob(workflowServiceId, selectedTechnicianId, reason);
        alert('Job rejected. In a real workflow, this would reassign to another technician.');
        previousStep();
      }
    }

    // Step 4: Check In
    function checkIn() {
      window.ygState.checkIn(workflowServiceId);

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 5: Toggle Checklist Item
    function toggleChecklistItem(itemId) {
      const item = document.querySelector(`#check-${itemId}`).parentElement;
      const checkbox = document.querySelector(`#check-${itemId}`);
      const checkIcon = checkbox.querySelector('i');

      checklistState[itemId - 1] = !checklistState[itemId - 1];

      if (checklistState[itemId - 1]) {
        item.classList.add('completed');
        checkIcon.style.display = 'block';
      } else {
        item.classList.remove('completed');
        checkIcon.style.display = 'none';
      }

      // Update state
      window.ygState.toggleChecklistItem(workflowServiceId, itemId);
    }

    // Step 5: Add Photo
    function addPhoto() {
      photoCount++;

      const photoGrid = document.getElementById('photoGrid');
      const photoItem = document.createElement('div');
      photoItem.className = 'photo-item';
      photoItem.innerHTML = '<i class="fas fa-image"></i>';

      // Insert before the add button
      photoGrid.insertBefore(photoItem, photoGrid.lastChild);

      // Update state
      window.ygState.addPhoto(workflowServiceId, {
        type: 'progress',
        label: `Photo ${photoCount}`,
        url: 'placeholder'
      });
    }

    // Step 5: Complete Job
    function completeJob() {
      // Check if at least some items are completed
      const completedCount = checklistState.filter(x => x).length;

      if (completedCount < 3) {
        alert('Please complete at least 3 checklist items before finishing.');
        return;
      }

      window.ygState.checkOut(workflowServiceId);

      // Update Step 6 WCF display
      const service = window.ygState.getService(workflowServiceId);
      document.getElementById('wcfServiceType').textContent = service.type;
      document.getElementById('wcfTechnician').textContent = selectedTechnicianName;
      document.getElementById('wcfDate').textContent = service.schedule.date;

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 6: Initialize Signature Pad
    function initSignaturePad() {
      signatureCanvas = document.getElementById('signaturePad');
      if (!signatureCanvas) return;

      signatureCtx = signatureCanvas.getContext('2d');

      // Set canvas size
      signatureCanvas.width = signatureCanvas.offsetWidth;
      signatureCanvas.height = signatureCanvas.offsetHeight;

      // Set drawing style
      signatureCtx.strokeStyle = '#1f2937';
      signatureCtx.lineWidth = 2;
      signatureCtx.lineCap = 'round';
      signatureCtx.lineJoin = 'round';

      // Mouse events
      signatureCanvas.addEventListener('mousedown', startDrawing);
      signatureCanvas.addEventListener('mousemove', draw);
      signatureCanvas.addEventListener('mouseup', stopDrawing);
      signatureCanvas.addEventListener('mouseout', stopDrawing);

      // Touch events
      signatureCanvas.addEventListener('touchstart', handleTouchStart);
      signatureCanvas.addEventListener('touchmove', handleTouchMove);
      signatureCanvas.addEventListener('touchend', stopDrawing);
    }

    function startDrawing(e) {
      isDrawing = true;
      const rect = signatureCanvas.getBoundingClientRect();
      signatureCtx.beginPath();
      signatureCtx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
    }

    function draw(e) {
      if (!isDrawing) return;
      const rect = signatureCanvas.getBoundingClientRect();
      signatureCtx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
      signatureCtx.stroke();
    }

    function stopDrawing() {
      isDrawing = false;
    }

    function handleTouchStart(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent('mousedown', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      signatureCanvas.dispatchEvent(mouseEvent);
    }

    function handleTouchMove(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent('mousemove', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      signatureCanvas.dispatchEvent(mouseEvent);
    }

    function clearSignature() {
      signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
    }

    // Step 6: Sign WCF
    function signWCF() {
      // Check if signature is drawn
      const imageData = signatureCtx.getImageData(0, 0, signatureCanvas.width, signatureCanvas.height);
      const hasSignature = imageData.data.some(x => x !== 0);

      if (!hasSignature) {
        alert('Please provide your signature before submitting.');
        return;
      }

      // Save signature
      const signatureData = signatureCanvas.toDataURL();
      window.ygState.signWCF(workflowServiceId, {
        data: signatureData,
        quality: 'approved'
      });

      // Update Step 7 display
      const service = window.ygState.getService(workflowServiceId);
      document.getElementById('finalServiceId').textContent = workflowServiceId;
      document.getElementById('finalCustomer').textContent = service.customer.name;
      document.getElementById('finalTechnician').textContent = selectedTechnicianName;

      const now = new Date();
      document.getElementById('finalCompletedTime').textContent =
        now.toLocaleDateString() + ' ' + now.toLocaleTimeString();

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Step 7: Process Payment
    function processPayment() {
      const paymentMethod = document.getElementById('paymentMethod').value;
      window.ygState.processPayment(workflowServiceId, paymentMethod);

      // Update Step 8 summary
      document.getElementById('summaryTechnician').textContent =
        `${selectedTechnicianName} assigned and completed the job`;

      // Auto-advance
      setTimeout(() => {
        nextStep();
      }, 500);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      console.log('YellowGrid Interactive Demo Loaded');
      console.log('State Management:', window.ygState);
    });
  </script>
</body>
</html>
